

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>True constants &mdash; ideas 0.0.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Json module" href="json.html" />
    <link rel="prev" title="Pythonic switch statement" href="switch.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ideas
          

          
          </a>

          
            
            
              <div class="version">
                0.0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="motivation.html"> Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html"> Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="repl.html"> Special console</a></li>
<li class="toctree-l1"><a class="reference internal" href="as_main.html"> Importing a module as main</a></li>
<li class="toctree-l1"><a class="reference internal" href="possible.html"> Overview of all possibilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="excluded.html"> Examples never included</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="function.html"> ``function`` as a keyword</a></li>
<li class="toctree-l1"><a class="reference internal" href="nobreak.html"> ``nobreak`` as a keyword</a></li>
<li class="toctree-l1"><a class="reference internal" href="french.html"> French Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="repeat.html"> ``repeat`` as a keyword</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda.html"> λ encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="ast.html"> Simple AST transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="bytecode.html"> Simple bytecode transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="switch.html"> Pythonic switch statement</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"> True constants</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#consenting-adults">Consenting adults</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to">How to</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-does-it-work">How does it work</a></li>
<li class="toctree-l2"><a class="reference internal" href="#suggestion-for-you">Suggestion for you</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ideas.examples.constants">Use the source, Luke</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="json.html"> Json module</a></li>
<li class="toctree-l1"><a class="reference internal" href="pep_505.html"> PEP 505: None-aware operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="non_files.html"> Import from non-standard locations</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="import_hook.html"> import_hook.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html"> utils.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="console.html"> console.py</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ideas</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>True constants</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/constants.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="json.html" class="btn btn-neutral float-right" title="Json module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="switch.html" class="btn btn-neutral float-left" title="Pythonic switch statement" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="true-constants">
<h1>True constants<a class="headerlink" href="#true-constants" title="Permalink to this headline">¶</a></h1>
<p><strong>Summary:</strong> How to ensure that variables defined as constants by some notational
convention are guaranteed not to change, without requiring them
to be attribute of an object.</p>
<p>This example demonstrates the use of:</p>
<ul class="simple">
<li><p>Source transformation to extract information from the source without changing its content.</p></li>
<li><p>Custom module class</p></li>
<li><p>Specialized dict to temporarily replace the read-only module dict.</p></li>
</ul>
<div class="section" id="consenting-adults">
<h2>Consenting adults<a class="headerlink" href="#consenting-adults" title="Permalink to this headline">¶</a></h2>
<p>Unlike some other programming languages that force their users to do things in a very strict fashion,
Python gives a lot of flexibility and assume that they are responsible adults,
capable of using common sense in their use of the language.
Thus, certain features considered to be absolutely essential in other languages,
such as keeping some variables hidden,
or forcing other variables to never have their type and sometimes not even their value changed once assigned, are not present in Python.
Instead, Pythonistas rely on conventions to indicate their intent.</p>
<ul>
<li><p>You want to indicate that a variable should be considered “private”? Just use a name starting with an underscore to communicate this to another programmer.</p>
<blockquote>
<div><ul class="simple">
<li><p>If that is not strong enough, use a double underscore to start its name. Other Python programmers will know what you mean.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>You want to indicate that a variable should be constant? Just write its name in UPPERCASE_LETTERS.</p>
<ul class="simple">
<li><p>For Python 3.8, use a <code class="docutils literal notranslate"><span class="pre">Final</span></code> qualifier type hint as per <a class="reference external" href="https://www.python.org/dev/peps/pep-0591/">PEP 591</a></p></li>
</ul>
</li>
</ul>
<p>Still, this does not prevent people from asking <em>“How do I create a constant in Python?”</em>
such as <a class="reference external" href="https://stackoverflow.com/questions/2682745/how-do-i-create-a-constant-in-python">was asked on StackOverflow</a>
some 9 years ago, which resulted in 34 different answers, almost all of which indicate that you cannot enforce this convention in Python at a module level.
Answers that were provided are still actively edited as new features get added to Python,
including recent comments about using the <code class="docutils literal notranslate"><span class="pre">Final</span></code> qualifier.</p>
<p>While it is noted that you can use tools such as <a class="reference external" href="http://mypy-lang.org/">mypy</a>
<strong>only to check</strong> without running the program
that a variable meant to be used as a constant is not expected to change,
all the other answers rely, in one way or another, on creating an object,
which can be <strong>another</strong> module,
and have the would-be constants defined as attribute to that object.
Such objects are carefully designed with properties that prevent
changes to the values of attributes intended to be constants.</p>
<p>However, this type of solution is more cumbersome to use than being able to simply
use an agred convention.
As Raymond Hettinger often says: <strong>there must be a better way</strong>. ;-)</p>
</div>
<div class="section" id="how-to">
<h2>How to<a class="headerlink" href="#how-to" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Explain how to use this module</p>
</div>
</div>
<div class="section" id="how-does-it-work">
<h2>How does it work<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Explain how it works</p>
</div>
</div>
<div class="section" id="suggestion-for-you">
<h2>Suggestion for you<a class="headerlink" href="#suggestion-for-you" title="Permalink to this headline">¶</a></h2>
<p>Try to implement your own variation, perhaps by introducing <code class="docutils literal notranslate"><span class="pre">let</span></code>
as a new keyword:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">let</span> <span class="n">this_variable</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># this_variable is thus declared as constant</span>
</pre></div>
</div>
</div>
<div class="section" id="module-ideas.examples.constants">
<span id="use-the-source-luke"></span><h2>Use the source, Luke<a class="headerlink" href="#module-ideas.examples.constants" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ideas.examples.constants.FinalDict">
<em class="property">class </em><code class="sig-prename descclassname">ideas.examples.constants.</code><code class="sig-name descname">FinalDict</code><span class="sig-paren">(</span><em class="sig-param">module_filename</em>, <em class="sig-param">on_prevent_change=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ideas/examples/constants.html#FinalDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ideas.examples.constants.FinalDict" title="Permalink to this definition">¶</a></dt>
<dd><p>dict subclass which ensures that constants are not over-written.</p>
<dl class="simple">
<dt>Constants are identified in two ways:</dt><dd><ol class="arabic simple">
<li><p>names in all UPPERCASE_LETTERS, which is a common convention</p></li>
<li><p>variables that were declared to be constant by the inclusion
of a “Final” type hint.</p></li>
</ol>
</dd>
</dl>
<p>Note: We only override methods which could result in changing the value
of a constant.</p>
<dl class="method">
<dt id="ideas.examples.constants.FinalDict.pop">
<code class="sig-name descname">pop</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span> &#x2192; value, remove specified key and return the corresponding value,<a class="reference internal" href="_modules/ideas/examples/constants.html#FinalDict.pop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ideas.examples.constants.FinalDict.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>unless the key is identifed as a constant.</p>
<p>If key is not found, d is returned if given, otherwise KeyError is raised</p>
</dd></dl>

<dl class="method">
<dt id="ideas.examples.constants.FinalDict.setdefault">
<code class="sig-name descname">setdefault</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ideas/examples/constants.html#FinalDict.setdefault"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ideas.examples.constants.FinalDict.setdefault" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert key with a value of default if key is not in the dictionary.</p>
<p>Prevents changes if the key is identified as a constant.</p>
</dd></dl>

<dl class="method">
<dt id="ideas.examples.constants.FinalDict.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param">mapping_or_iterable=()</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ideas/examples/constants.html#FinalDict.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ideas.examples.constants.FinalDict.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the content of the dict from a mapping or an iterable,
or from a list of keywords arguments.</p>
<p>Keys identified as constants are prevented from changing.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ideas.examples.constants.add_hook">
<code class="sig-prename descclassname">ideas.examples.constants.</code><code class="sig-name descname">add_hook</code><span class="sig-paren">(</span><em class="sig-param">on_prevent_change=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ideas/examples/constants.html#add_hook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ideas.examples.constants.add_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and adds the import hook in sys.meta_path</p>
</dd></dl>

<dl class="function">
<dt id="ideas.examples.constants.tear_down">
<code class="sig-prename descclassname">ideas.examples.constants.</code><code class="sig-name descname">tear_down</code><span class="sig-paren">(</span><em class="sig-param">hook</em>, <em class="sig-param">module</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ideas/examples/constants.html#tear_down"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ideas.examples.constants.tear_down" title="Permalink to this definition">¶</a></dt>
<dd><p>Useful for testing and isolating import hooks</p>
</dd></dl>

<dl class="function">
<dt id="ideas.examples.constants.transform_source">
<code class="sig-prename descclassname">ideas.examples.constants.</code><code class="sig-name descname">transform_source</code><span class="sig-paren">(</span><em class="sig-param">source</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/ideas/examples/constants.html#transform_source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ideas.examples.constants.transform_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies simple assignments with a Final type hint, returning
the source unchanged.</p>
<dl class="simple">
<dt>Pattern we are looking for::</dt><dd><p>python_identifier : Final …</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="json.html" class="btn btn-neutral float-right" title="Json module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="switch.html" class="btn btn-neutral float-left" title="Pythonic switch statement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, André Roberge

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>